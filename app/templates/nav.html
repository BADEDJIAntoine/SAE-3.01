<nav class="navbar fixed-top navbar-expand-sm navbar-dark" style="background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); border-bottom: 1px solid rgba(255, 255, 255, 0.2);">
    <div class="container-fluid">
        <a class="navbar-brand fw-bold" href="{{ url_for('index') }}">
            <i class="bi bi-cpu"></i> RYTHMO
        </a>

        <ul class="navbar-nav me-auto">
            {% for menu_item in ["index", "infos"] %}
                <li class="nav-item">
                    {# On vérifie si la route existe avant d'essayer de générer l'URL #}
                    <a class="nav-link {{ 'active fw-bold border-bottom' if menu_item == metadata.pagename else '' }}" 
                       href="{{ url_for(menu_item) if menu_item == 'index' else '#' }}" 
                       style="color: white; margin-right: 15px;">
                        {{ menu_item|capitalize }}
                    </a>
                </li>
            {% endfor %}
        </ul>

        <div class="d-flex align-items-center">
            {# On vérifie les deux variantes possibles du rôle admin #}
            {% if session.get("role") in ["admin", "Administrateur"] %}
                <a href="#" class="btn btn-sm btn-outline-warning me-3">
                    <i class="bi bi-shield-lock"></i> Admin Panel
                </a>
            {% endif %}

            {% if session.get("logged") %}
                <span class="text-white me-3">
                    {# CORRECTION : Utilisation de la clé définie dans LoginController #}
                    <i class="bi bi-person-circle"></i> {{ session["nom_utilisateur"] }}
                </span>
                <a href="{{ url_for('logout') }}" class="btn btn-sm btn-danger shadow-sm">
                    <i class="bi bi-box-arrow-right"></i> Logout
                </a>
            {% else %}
                <a href="{{ url_for('login') }}" class="btn btn-sm btn-light fw-bold px-4 shadow-sm">
                    Login
                </a>
            {% endif %}
        </div>
    </div>
</nav>